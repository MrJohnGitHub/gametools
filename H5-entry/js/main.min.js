var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{c(n.next(e))}catch(t){a(t)}}function s(e){try{c(n["throw"](e))}catch(t){a(t)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(o,s)}c((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=a[2&r[0]?"return":r[0]?"throw":"next"])&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[0,o.value]),r[0]){case 0:case 1:o=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,a=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){c.label=r[1];break}if(6===r[0]&&c.label<o[1]){c.label=o[1],o=r;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(r);break}o[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(n){r=[6,n],a=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},SimplePlatform=function(){function e(){this.userID="",this.token="",this.resRoot="",this.svrName="",this.svrID="",this.wsLoginURL="",this.wssLoginURL="",this.wsGateURL="",this.wssGateURL="",this.svrIp="",this.svrPort=0,this.gateIp="",this.gatePort=0,this.initByLocation(),this.initBackStage()}return Object.defineProperty(e.prototype,"isDebug",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"account",{get:function(){return this.channelName+"-"+this.userID},enumerable:!0,configurable:!0}),e.prototype.initByLocation=function(){this.platID=+LocationParam.getValue("plat_id")||0,this.userID=LocationParam.getValue("uid")||"",this.channel=LocationParam.getValue("channel")||"",this.channelUID=LocationParam.getValue("channelUid")||"",this.token=LocationParam.getValue("token")||"",this.resRoot=LocationParam.getValue("resurl")||"",this.svrID=LocationParam.getValue("sid")||"",this.svrName=LocationParam.getValue("sname")||"",this.wsLoginURL=LocationParam.getValue("wsurl")||"",this.wssLoginURL=LocationParam.getValue("wssurl")||""},e.prototype.initBackStage=function(){this.backUrlAddr="home.xh5.mikeyouxi.com",this.backUrlKey="4c4776e8db27d196ae19ddbb60143488"},e.prototype.init=function(){return new Promise(function(e,t){e()})},e.prototype.login=function(){return new Promise(function(e,t){e()})},e.prototype.getLoginUrl=function(){return LocationParam.isHttps()?"wss://"+this.wssLoginURL:"ws://"+this.wsLoginURL},e.prototype.getGateUrl=function(){return LocationParam.isHttps()?"wss://"+this.wssGateURL:"ws://"+this.wsGateURL},e.prototype.uploadSelectSvr=function(e){},e.prototype.uploadCreateRole=function(e){},e.prototype.uploadEnterGame=function(e){},e.prototype.uploadLvUp=function(e){},e.prototype.uploadExitGame=function(e){},e}();__reflect(SimplePlatform.prototype,"SimplePlatform");var BaseScene=function(){function e(){this.uiLayer=new eui.UILayer,this.uiLayer.percentHeight=100,this.uiLayer.percentWidth=100,this.uiLayer.touchEnabled=!1}return e.prototype.onEnter=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.getStage().addChild(this.uiLayer)},e.prototype.onExit=function(){this.getStage().removeChild(this.uiLayer)},e.prototype.getStage=function(){return egret.lifecycle.stage},e}();__reflect(BaseScene.prototype,"BaseScene");var BaseSceneView=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=t.percentHeight=100,t}return __extends(t,e),t}(eui.Component);__reflect(BaseSceneView.prototype,"BaseSceneView");var SceneManager=function(){function e(){}return e.prototype.clear=function(){var e=this._currScene;e&&(e.onExit(),this._currScene=null)},e.prototype.runScene=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this._currScene;if(n){if(n instanceof e)return;n.onExit()}this._currScene=new e,(i=this._currScene).onEnter.apply(i,t);var i},e.prototype.getCurrScene=function(){return this._currScene},e}();__reflect(SceneManager.prototype,"SceneManager");var YueWanPlatform=function(e){function t(){var t=e.call(this)||this;return t.sdk=new window.JSLIB,t.channelName="YUEWEN",t}return __extends(t,e),t.prototype.initBackStage=function(){this.backUrlAddr="home.cqmijiu.com",this.backUrlKey="4c4776e8db27d196ae19ddbb60143488"},t.prototype.login=function(){var e=this;return new Promise(function(t,r){var n=e.sdk;n.getUser(function(r){return __awaiter(e,void 0,void 0,function(){var e,i,a;return __generator(this,function(o){switch(o.label){case 0:return console.log(r.session_id),console.log(r.type),console.log(r.os),console.log(r.devicetype),e=r.session_id,i=BackStageReqUtils.getYueWanLoginAddr()+"?authorize_code="+e,[4,BackStageReqUtils.sendBackStageReq(i)];case 1:return a=o.sent(),1==a.ret&&(this.userID=a.content.user_id,this.userName=a.content.user_name,this.time=a.content.time,this.token=a.content.token,n.setUser({session_id:a.content.access_token,uid:this.userID,name:this.userName}),n.shutDown("shutDown"),t()),[2]}})})})})},t}(SimplePlatform);__reflect(YueWanPlatform.prototype,"YueWanPlatform");var DebugPlatform=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.initByLocation=function(){this.platID=PlatType.Debug},t.prototype.initBackStage=function(){this.backUrlAddr="10.5.70.4:8090",this.backUrlKey="4c4776e8db27d196ae19ddbb60143488"},Object.defineProperty(t.prototype,"isDebug",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(SimplePlatform);__reflect(DebugPlatform.prototype,"DebugPlatform");var MiKePlatform=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"account",{get:function(){return this.channelName+"-"+this.userID},enumerable:!0,configurable:!0}),t.prototype.init=function(){return new Promise(function(e,t){window.SDKjh.showInit(function(r){0==+r.status?e():t("聚合SDK初始化失败")})})},t.prototype.login=function(){var e=this;return new Promise(function(t,r){window.SDKjh.showLoginView(function(n){0==+n.status?(e.userID=n.userId,e.token=n.accessToken,e.channelName=n.channelName,e.channelUID=n.channelUid,t()):r("聚合SDK登录失败")})})},t.prototype.getChannelID=function(){return this.channelName+"_"+this.channelUID},t}(SimplePlatform);__reflect(MiKePlatform.prototype,"MiKePlatform");var PlatType=function(){function e(){}return e.Debug=5e3,e.MiKe=1,e.YueWan=5001,e}();__reflect(PlatType.prototype,"PlatType");var App=function(){function e(){}return e.getYueWanDebugUrl=function(){var e=Date.now(),t=this.gameUrl,r=this.signKey,n=1703,i=encodeURIComponent(t).toLowerCase(),a=MD5.hex_md5("debug_url="+i+"&j_game_id="+n+"&j_game_secret="+r+"&time="+e);return"http://japi.game-props.com/h5/entryPage?debug_url="+t+"&j_game_id="+n+"&time="+e+"&sign="+a},e.SceneManager=new SceneManager,e.gameUrl="http://10.5.10.19:8200/H5-frontend/h5entry/client.html?plat_id=5001",e.signKey="7ed3417b7a5103e5104738a040c2e0a0",e}();__reflect(App.prototype,"App");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){},RES.getVirtualUrl=function(e){return window.publishVer?window.publishVer+"/"+e:e+"?v="+window.debugVer},this.uiLayer=new eui.UILayer,this.uiLayer.percentHeight=100,this.uiLayer.percentWidth=100,this.uiLayer.touchEnabled=!1,egret.lifecycle.stage.addChild(this.uiLayer),this.backImg=new eui.Image,this.backImg.horizontalCenter=this.backImg.verticalCenter=0,this.uiLayer.addChild(this.backImg);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),egret.ImageLoader.crossOrigin="anonymous",LocationParam.parseLocation(),this.initPlatform(),this.loginPlat(),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.initPlatform=function(){var e=LocationParam.getValue("plat_id")||PlatType.Debug;switch(+e){case PlatType.MiKe:window.platform=new MiKePlatform;break;case PlatType.YueWan:window.platform=new YueWanPlatform;break;case PlatType.Debug:window.platform=new DebugPlatform}},t.prototype.loginPlat=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:if(!window.platform.platID)return[3,7];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,BackStageReqUtils.loadBackStageConfig()];case 2:return r.sent(),[4,window.platform.init()];case 3:return r.sent(),[4,window.platform.login()];case 4:return r.sent(),BackStageReqUtils.sendOpenReq(),[4,BackStageReqUtils.sendBackStageReq(BackStageReqUtils.getNowSvrTimeAddr(),{nowtime:Date.now()/1e3>>0})];case 5:return e=r.sent(),0==+e.stat&&BackStageReqUtils.updateNowSvrTime(e.data),this.uiLayer.parent&&this.uiLayer.parent.removeChild(this.uiLayer),this.showSelectServerScene(),[3,7];case 6:return t=r.sent(),this.loginPlat(),[3,7];case 7:return[2]}})})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.backImg.source="denglubg_jpg",this.loadResComplete=!0,this.showSelectServerScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e="resource/res.pub.json",[4,RES.loadConfig(e,"resource/")];case 1:return r.sent(),[4,this.loadTheme()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,r){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.showSelectServerScene=function(){return this.loadResComplete?window.platform.isDebug?void App.SceneManager.runScene(PlatLoginScene):void(window.platform.userID&&App.SceneManager.runScene(SelectServerScene)):void 0},t}(eui.UILayer);__reflect(Main.prototype,"Main");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function n(n){t.call(r,n,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?n(i):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var PlatLoginScene=function(e){function t(){var t=e.call(this)||this;return t.loginView=new PlatLoginView,t.uiLayer.addChild(t.loginView),t}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this)},t}(BaseScene);__reflect(PlatLoginScene.prototype,"PlatLoginScene");var PlatLoginView=function(e){function t(){var t=e.call(this)||this;return t.skinName="LoginSceneSkin",t}return __extends(t,e),t.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchLogin,this),this.accountInput.text=egret.localStorage.getItem("debug_uid"),this.accountInput.text=egret.localStorage.getItem("debug_token")},t.prototype.onTouchLogin=function(){this.accountInput.text&&(window.platform.platID=5e3,window.platform.userID=this.accountInput.text,window.platform.token=this.pwdInput.text,egret.localStorage.setItem("debug_uid",window.platform.userID),egret.localStorage.setItem("debug_token",window.platform.token),App.SceneManager.runScene(SelectServerScene))},t}(BaseSceneView);__reflect(PlatLoginView.prototype,"PlatLoginView");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,n){function i(e){t.call(n,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),r.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,r){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(c,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){t.call(n,generateJSON.paths[e])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var SelectServerScene=function(e){function t(){var t=e.call(this)||this;return t.selectServerView=new SelectServerView,t.uiLayer.addChild(t.selectServerView),t}return __extends(t,e),t}(BaseScene);__reflect(SelectServerScene.prototype,"SelectServerScene");var SelectServerView=function(e){function t(){var t=e.call(this)||this;return t.pageSize=10,t.skinName="EnterGameSceneSkin",t.tipsLabel.visible=!1,t.pageList.itemRenderer=ServerPageItemRender,t.serverList.itemRenderer=ServerItemRender,t.pageList.dataProvider.source=[],t.serverList.dataProvider.source=[],t.gonggaoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchGongGao,t),t.selectBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchSelect,t),t.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchClose,t),t.enterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTouchEnter,t),t.pageList.addEventListener(egret.Event.CHANGE,t.onPageChanged,t),t.serverList.addEventListener(egret.Event.CHANGE,t.onServerChanged,t),t.reqMySvrList(),t}return __extends(t,e),t.prototype.onTouchGongGao=function(){this.gongGaoGrp&&(this.gongGaoGrp.visible=!0),this.reqGongGao()},t.prototype.onSuggestSvrsLoaded=function(){for(var e=+this.suggestData.total,t=Math.floor(e/this.pageSize)+(e%this.pageSize>0?1:0),r=[],n=0;t>n;n++){var i={};i.page=n+1;var a=n*this.pageSize+1,o=(n+1)*this.pageSize;i.name=a+"-"+o+"服",r.push(i)}r.push({isMy:!0,name:"最近登录"}),r=r.reverse(),this.pageList.dataProvider.source=r,this.setSelectSvr(this.suggestData.mine[0]||this.suggestData.tj[0])},t.prototype.setSelectSvr=function(e){this.tipsLabel.visible=!1,this.selectedServer=e,this.svrStateIcon.source="svr_state_"+e.state+"_png",this.svrNameLabel.text=e.zname},t.prototype.onTouchSelect=function(){this.selectSvrGrp.visible=!0,this.pageList.selectedIndex=0,this.updateServerPage()},t.prototype.updateServerPage=function(e){if(e)return void(this.serverList.dataProvider.source=e);var t=this.pageList.selectedItem;return t.isMy?void(this.serverList.dataProvider.source=this.suggestData.mine):(this.serverList.dataProvider.source=[],void this.reqSvrListByPage(t.page,this.pageSize))},t.prototype.onTouchClose=function(){this.selectSvrGrp.visible=!1},t.prototype.onTouchEnter=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r,n,i,a,o;return __generator(this,function(s){switch(s.label){case 0:return e=window.platform,t=this.selectedServer,t?[4,BackStageReqUtils.sendBackStageReq(BackStageReqUtils.getSingleSvrInfoAddr(),{ptid:e.platID,zid:t.zid})]:[2];case 1:return r=s.sent(),r.stat?(n=r.data,n.zid!=this.selectedServer.zid?[2]:(t=this.selectedServer,t.state=n.state,t.open_time=n.open_time,i=+this.selectedServer.state,i==ServerState.daikai||BackStageReqUtils.getNowSvrTime()<(+t.open_time||0)?(this.tipsLabel.text="服务器即将开启",this.tipsLabel.visible=!0,[2]):i==ServerState.weihu?(this.tipsLabel.text="服务器维护中",this.tipsLabel.visible=!0,[2]):(this.tipsLabel.visible=!1,e.svrID=t.zid,BackStageReqUtils.sendUserLogin(),a=BackStageReqUtils.getGameClientAddr(),o=""+LocationParam.getProtocol()+a+"game.html?plat_id="+e.platID+("&uid="+e.userID)+(e.userName?"&username="+e.userName:"")+(e.time?"&time="+e.time:"")+(e.channelUID?"&channelUid="+e.channelUID:"")+(e.channelName?"&channel="+e.channelName:"")+("&token="+e.token)+("&resurl="+a)+("&sid="+this.selectedServer.zid)+("&sname="+this.selectedServer.zname)+("&wsurl="+this.selectedServer.ip+":"+this.selectedServer.port),window.location.href=o,[2]))):[2]}})})},t.prototype.onPageChanged=function(){this.updateServerPage()},t.prototype.onServerChanged=function(){this.setSelectSvr(this.serverList.selectedItem),this.selectSvrGrp.visible=!1},t.prototype.reqGongGao=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r,n;return __generator(this,function(i){switch(i.label){case 0:if(this.gonggaoData)return this.updateGongGao(),[2];e=BackStageReqUtils.getGongGaoAddr(),t={ptid:window.platform.platID},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,BackStageReqUtils.sendBackStageReq(e,t)];case 2:return r=i.sent(),0!=+r.stat?[2]:(this.gonggaoData=r.data,this.updateGongGao(),[3,4]);case 3:return n=i.sent(),[3,4];case 4:return[2]}})})},t.prototype.updateGongGao=function(){this.gongGaoLabel&&(this.gongGaoLabel.text=this.gonggaoData.content)},t.prototype.reqMySvrList=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r,n;return __generator(this,function(i){switch(i.label){case 0:e=BackStageReqUtils.getMySvrListAddr(),t={ptid:window.platform.platID,account:window.platform.account,time:Date.now(),version:0},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,BackStageReqUtils.sendBackStageReq(e,t)];case 2:return r=i.sent(),this.suggestData=r.data,this.onSuggestSvrsLoaded(),[3,4];case 3:return n=i.sent(),[3,4];case 4:return[2]}})})},t.prototype.reqSvrListByPage=function(e,t){return __awaiter(this,void 0,void 0,function(){var r,n,i,a;return __generator(this,function(o){switch(o.label){case 0:r=BackStageReqUtils.getPageSvrListAddr(),n={ptid:window.platform.platID,version:0,page:e,row:t,time:Date.now()},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,BackStageReqUtils.sendBackStageReq(r,n)];case 2:return i=o.sent(),this.updateServerPage(i.zones),[3,4];case 3:return a=o.sent(),[3,4];case 4:return[2]}})})},t}(BaseSceneView);__reflect(SelectServerView.prototype,"SelectServerView");var ServerPageItemRender=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.nameLabel.text=this.data.name},t}(eui.ItemRenderer);__reflect(ServerPageItemRender.prototype,"ServerPageItemRender");var ServerItemRender=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;this.stateIcon.source="svr_state_"+t.state+"_png",this.nameLabel.text=t.zname,this.suggestIcon.visible="0"==t.state},t}(eui.ItemRenderer);__reflect(ServerItemRender.prototype,"ServerItemRender");var ServerState;!function(e){e[e.tuijian=0]="tuijian",e[e.zhengchang=1]="zhengchang",e[e.huobao=2]="huobao",e[e.yongji=3]="yongji",e[e.tongchang=4]="tongchang",e[e.daikai=5]="daikai",e[e.weihu=6]="weihu"}(ServerState||(ServerState={}));var BackStageReqUtils=function(){function e(){}return e.updateNowSvrTime=function(e){this._svrTime=+e,this._syncTime=egret.getTimer()},e.getNowSvrTime=function(){return this._svrTime?this._svrTime+(egret.getTimer()-this._syncTime)/1e3:Date.now()/1e3},e.loadBackStageConfig=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r;return __generator(this,function(n){switch(n.label){case 0:e={ptid:window.platform.platID,time:Date.now(),version:0},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.sendBackStageReq(window.platform.backUrlAddr+"/Server/gameconfig",e)];case 2:return t=n.sent(),this.backStageConfigs=t.data,[3,4];case 3:return r=n.sent(),console.error(r),[3,4];case 4:return[2]}})})},e.sendUserLogin=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r,n;return __generator(this,function(i){switch(i.label){case 0:e=this.backStageConfigs[0].apiUrl+"/Login/userlogin",t={ptid:window.platform.platID,zid:window.platform.svrID,account:window.platform.account},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.sendBackStageReq(""+e,t)];case 2:return r=i.sent(),this.backStageConfigs=r.data,[3,4];case 3:return n=i.sent(),console.error(n),[3,4];case 4:return[2]}})})},e.md5BackStageReqParam=function(e){var t=Object.keys(e);t.sort();for(var r="",n="",i=0;i<t.length;i++){var a=t[i];i>0&&(r+="&");var o=e[a];r+=a+"="+o}n=r+"&key="+window.platform.backUrlKey;var s=MD5.hex_md5(n);return r+="&sign="+s},e.sendBackStageReq=function(e,t){var r=this;return new Promise(function(n,i){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT;var o=function(t){switch(t.type){case egret.Event.COMPLETE:var r=JSON.parse(a.response);n(r);break;case egret.IOErrorEvent.IO_ERROR:console.log("请求失败："+e),i(r)}};if(a.once(egret.Event.COMPLETE,o,r),a.once(egret.IOErrorEvent.IO_ERROR,o,r),t){var s=r.md5BackStageReqParam(t);e+="?"+s}a.open(""+LocationParam.getProtocol()+e,egret.HttpMethod.GET),a.send()})},e.sendOpenReq=function(){var t=3,r=navigator.userAgent.toLowerCase();r.indexOf("android")>=0?t=1:(r.indexOf("ios")>=0||r.indexOf("ipad")>=0)&&(t=2),e.sendBackStageReq(e.getOpenAddr(),{ptid:window.platform.platID,appid:t,phonecode:MD5.hex_md5(r),time:Date.now()/1e3>>0})},e.getGameClientAddr=function(){return""+this.backStageConfigs[0].resBaseUrl},e.getYueWanLoginAddr=function(){return this.backStageConfigs[0].commurl+"/YuewanLogin/login"},e.getGongGaoAddr=function(){return this.backStageConfigs[0].apiUrl+"/server/gonggao"},e.getMySvrListAddr=function(){return this.backStageConfigs[0].apiUrl+"/Newserver/selectzone"},e.getPageSvrListAddr=function(){return this.backStageConfigs[0].apiUrl+"/Newserver/list"},e.getSingleSvrInfoAddr=function(){return this.backStageConfigs[0].apiUrl+"/Newserver/info"},e.getLoginRecordAddr=function(){return this.backStageConfigs[0].apiUrl+"/Login/userlogin"},e.getNowSvrTimeAddr=function(){return this.backStageConfigs[0].commurl+"/Server/nowtime"},e.getOpenAddr=function(){return this.backStageConfigs[0].apiUrl+"/Open/addlog"},e}();__reflect(BackStageReqUtils.prototype,"BackStageReqUtils");var LocationParam=function(){function e(){}return e.parseLocation=function(){for(var e=window.location.href,t=e.indexOf("?"),r=e.substr(t+1),n={},i=r.split("&"),a=0;a<i.length;a++){var o=i[a].indexOf("=");if(o>0){var s=i[a].substring(0,o),c=i[a].substr(o+1);n[s]=c}}this.param=n,this._isHttps=window.location.protocol.indexOf("https:")>=0},e.isHttps=function(){return this._isHttps},e.getValue=function(e){return this.param[e]},e.getProtocol=function(){return window.location.protocol+"//"},e}();__reflect(LocationParam.prototype,"LocationParam");var MD5=function(){function e(){}return e.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.any_hmac_md5=function(e,t,r){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),r)},e.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.rstr_hmac_md5=function(e,t){var r=this.rstr2binl(e);r.length>16&&(r=this.binl_md5(r,8*e.length));for(var n=Array(16),i=Array(16),a=0;16>a;a++)n[a]=909522486^r[a],i[a]=1549556828^r[a];var o=this.binl_md5(n.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(i.concat(o),640))},e.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var r,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",a=0;a<e.length;a++)r=e.charCodeAt(a),i+=n.charAt(r>>>4&15)+n.charAt(15&r);return i},e.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=e.length,a=0;i>a;a+=3)for(var o=e.charCodeAt(a)<<16|(i>a+1?e.charCodeAt(a+1)<<8:0)|(i>a+2?e.charCodeAt(a+2):0),s=0;4>s;s++)n+=8*a+6*s>8*e.length?this.b64pad:r.charAt(o>>>6*(3-s)&63);return n},e.rstr2any=function(e,t){var r,n,i,a,o,s=t.length,c=Array(Math.ceil(e.length/2));for(r=0;r<c.length;r++)c[r]=e.charCodeAt(2*r)<<8|e.charCodeAt(2*r+1);var u=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),h=Array(u);for(n=0;u>n;n++){for(o=Array(),a=0,r=0;r<c.length;r++)a=(a<<16)+c[r],i=Math.floor(a/s),a-=i*s,(o.length>0||i>0)&&(o[o.length]=i);h[n]=a,c=o}var l="";for(r=h.length-1;r>=0;r--)l+=t.charAt(h[r]);return l},e.str2rstr_utf8=function(e){for(var t,r,n="",i=-1;++i<e.length;)t=e.charCodeAt(i),r=i+1<e.length?e.charCodeAt(i+1):0,t>=55296&&56319>=t&&r>=56320&&57343>=r&&(t=65536+((1023&t)<<10)+(1023&r),i++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n},e.str2rstr_utf16le=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(255&e.charCodeAt(r),e.charCodeAt(r)>>>8&255);return t},e.str2rstr_utf16be=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e.charCodeAt(r)>>>8&255,255&e.charCodeAt(r));return t},e.rstr2binl=function(e){for(var t=Array(e.length>>2),r=0;r<t.length;r++)t[r]=0;for(var r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t},e.binl2rstr=function(e){for(var t="",r=0;r<32*e.length;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t},e.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var r=1732584193,n=-271733879,i=-1732584194,a=271733878,o=0;o<e.length;o+=16){var s=r,c=n,u=i,h=a;r=this.md5_ff(r,n,i,a,e[o+0],7,-680876936),a=this.md5_ff(a,r,n,i,e[o+1],12,-389564586),i=this.md5_ff(i,a,r,n,e[o+2],17,606105819),n=this.md5_ff(n,i,a,r,e[o+3],22,-1044525330),r=this.md5_ff(r,n,i,a,e[o+4],7,-176418897),a=this.md5_ff(a,r,n,i,e[o+5],12,1200080426),i=this.md5_ff(i,a,r,n,e[o+6],17,-1473231341),n=this.md5_ff(n,i,a,r,e[o+7],22,-45705983),r=this.md5_ff(r,n,i,a,e[o+8],7,1770035416),a=this.md5_ff(a,r,n,i,e[o+9],12,-1958414417),i=this.md5_ff(i,a,r,n,e[o+10],17,-42063),n=this.md5_ff(n,i,a,r,e[o+11],22,-1990404162),r=this.md5_ff(r,n,i,a,e[o+12],7,1804603682),a=this.md5_ff(a,r,n,i,e[o+13],12,-40341101),i=this.md5_ff(i,a,r,n,e[o+14],17,-1502002290),n=this.md5_ff(n,i,a,r,e[o+15],22,1236535329),r=this.md5_gg(r,n,i,a,e[o+1],5,-165796510),a=this.md5_gg(a,r,n,i,e[o+6],9,-1069501632),i=this.md5_gg(i,a,r,n,e[o+11],14,643717713),n=this.md5_gg(n,i,a,r,e[o+0],20,-373897302),r=this.md5_gg(r,n,i,a,e[o+5],5,-701558691),a=this.md5_gg(a,r,n,i,e[o+10],9,38016083),i=this.md5_gg(i,a,r,n,e[o+15],14,-660478335),n=this.md5_gg(n,i,a,r,e[o+4],20,-405537848),r=this.md5_gg(r,n,i,a,e[o+9],5,568446438),a=this.md5_gg(a,r,n,i,e[o+14],9,-1019803690),i=this.md5_gg(i,a,r,n,e[o+3],14,-187363961),n=this.md5_gg(n,i,a,r,e[o+8],20,1163531501),r=this.md5_gg(r,n,i,a,e[o+13],5,-1444681467),a=this.md5_gg(a,r,n,i,e[o+2],9,-51403784),i=this.md5_gg(i,a,r,n,e[o+7],14,1735328473),n=this.md5_gg(n,i,a,r,e[o+12],20,-1926607734),r=this.md5_hh(r,n,i,a,e[o+5],4,-378558),a=this.md5_hh(a,r,n,i,e[o+8],11,-2022574463),i=this.md5_hh(i,a,r,n,e[o+11],16,1839030562),n=this.md5_hh(n,i,a,r,e[o+14],23,-35309556),r=this.md5_hh(r,n,i,a,e[o+1],4,-1530992060),a=this.md5_hh(a,r,n,i,e[o+4],11,1272893353),i=this.md5_hh(i,a,r,n,e[o+7],16,-155497632),n=this.md5_hh(n,i,a,r,e[o+10],23,-1094730640),r=this.md5_hh(r,n,i,a,e[o+13],4,681279174),a=this.md5_hh(a,r,n,i,e[o+0],11,-358537222),i=this.md5_hh(i,a,r,n,e[o+3],16,-722521979),n=this.md5_hh(n,i,a,r,e[o+6],23,76029189),r=this.md5_hh(r,n,i,a,e[o+9],4,-640364487),a=this.md5_hh(a,r,n,i,e[o+12],11,-421815835),i=this.md5_hh(i,a,r,n,e[o+15],16,530742520),n=this.md5_hh(n,i,a,r,e[o+2],23,-995338651),r=this.md5_ii(r,n,i,a,e[o+0],6,-198630844),a=this.md5_ii(a,r,n,i,e[o+7],10,1126891415),i=this.md5_ii(i,a,r,n,e[o+14],15,-1416354905),n=this.md5_ii(n,i,a,r,e[o+5],21,-57434055),r=this.md5_ii(r,n,i,a,e[o+12],6,1700485571),a=this.md5_ii(a,r,n,i,e[o+3],10,-1894986606),i=this.md5_ii(i,a,r,n,e[o+10],15,-1051523),n=this.md5_ii(n,i,a,r,e[o+1],21,-2054922799),r=this.md5_ii(r,n,i,a,e[o+8],6,1873313359),a=this.md5_ii(a,r,n,i,e[o+15],10,-30611744),i=this.md5_ii(i,a,r,n,e[o+6],15,-1560198380),n=this.md5_ii(n,i,a,r,e[o+13],21,1309151649),r=this.md5_ii(r,n,i,a,e[o+4],6,-145523070),a=this.md5_ii(a,r,n,i,e[o+11],10,-1120210379),i=this.md5_ii(i,a,r,n,e[o+2],15,718787259),n=this.md5_ii(n,i,a,r,e[o+9],21,-343485551),r=this.safe_add(r,s),n=this.safe_add(n,c),i=this.safe_add(i,u),a=this.safe_add(a,h)}return[r,n,i,a]},e.md5_cmn=function(e,t,r,n,i,a){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(n,a)),i),r)},e.md5_ff=function(e,t,r,n,i,a,o){return this.md5_cmn(t&r|~t&n,e,t,i,a,o)},e.md5_gg=function(e,t,r,n,i,a,o){return this.md5_cmn(t&n|r&~n,e,t,i,a,o)},e.md5_hh=function(e,t,r,n,i,a,o){return this.md5_cmn(t^r^n,e,t,i,a,o)},e.md5_ii=function(e,t,r,n,i,a,o){return this.md5_cmn(r^(t|~n),e,t,i,a,o)},e.safe_add=function(e,t){var r=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(r>>16);return n<<16|65535&r},e.bit_rol=function(e,t){return e<<t|e>>>32-t},e.hexcase=0,e.b64pad="",e}();__reflect(MD5.prototype,"MD5");var RequestUtils=function(){function e(){}return e.sendSimpleReq=function(e,t,r){var n=this;return void 0===r&&(r=egret.HttpResponseType.TEXT),new Promise(function(i,a){var o=new egret.HttpRequest;o.responseType=r;var s=function(t){switch(t.type){case egret.Event.COMPLETE:i(o.response);break;case egret.IOErrorEvent.IO_ERROR:a("加载失败："+e)}};if(o.once(egret.Event.COMPLETE,s,n),o.once(egret.IOErrorEvent.IO_ERROR,s,n),t){var c=n.param2ReqSearchStr(t);e+="?"+c}o.open(""+LocationParam.getProtocol()+e,egret.HttpMethod.GET),o.send()})},e.param2ReqSearchStr=function(e){for(var t=Object.keys(e),r="",n=0;n<t.length;n++){var i=t[n];n>0&&(r+="&");var a=e[i];r+=i+"="+a}return r},e}();__reflect(RequestUtils.prototype,"RequestUtils");